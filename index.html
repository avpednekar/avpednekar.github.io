<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Pose-controlled Music Webapp</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { margin: 0; font-family: Arial, sans-serif; display:flex; gap:20px; padding:20px; background:#111; color:#eee; align-items:flex-start; }
    #left { width:640px; }
    #controls { width:360px; display:flex; flex-direction:column; gap:12px; }
    canvas { background:#222; border-radius:8px; }
    button, select { padding:10px; font-size:16px; border-radius:6px; border: none; }
    .big { font-size:18px; padding:12px; }
    .info { background:#141414; padding:12px; border-radius:8px; color:#ddd; }
    label { font-size:14px; }
  </style>
  <!-- MediaPipe Pose JS (cdn) -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose@0.5/pose.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
</head>
<body>
  <div id="left">
    <video id="video" autoplay playsinline style="display:none;"></video>
    <canvas id="canvas" width="640" height="480"></canvas>
  </div>

  <div id="controls">
    <div class="info">
      <div><strong>Controls:</strong></div>
      <div>ðŸ‘‹ Left wrist â†’ tap origin circle â†’ tempo/BPM</div>
      <div>âœ‹ Right wrist â†’ up/down â†’ volume</div>
    </div>

    <select id="songSelect" class="big">
      <option value="">Select a song</option>
      <option value="adagietto.mp3">Mahler Adagietto</option>
      <option value="https://drive.google.com/uc?export=download&id=1IXkMTfYC-JwiN6p9kIB28trcn1-MvjkC">Mozart Nachtmusik</option>
      <option value="https://drive.google.com/uc?export=download&id=1Vv2nGpouHiXRGIa3npB08VrwHJr_obPc">Tchaikovsky Fairy</option>
    </select>

    <button id="startBtn" class="big">Start</button>
    <button id="stopBtn" class="big" disabled>Stop</button>

    <div class="info">
      <div>Status: <span id="status">idle</span></div>
      <div>BPM: <span id="bpm">â€”</span></div>
      <div>Speed: <span id="speed">1.00</span>x</div>
      <div>Volume: <span id="vol">0.50</span></div>
    </div>
  </div>

  async function initCamera() {
    try {
      const stream = await navigator.mediaDevices.getUserMedia({ video: true });
      const video = document.getElementById("camera");
      video.srcObject = stream;
    } catch (err) {
      console.error("Camera access denied:", err);
      alert("Could not access camera. Please allow permissions.");
    }
  }

  window.onload = initCamera;
</script>
</body>
</html>
